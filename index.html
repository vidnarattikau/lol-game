<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš”ï¸ è‹±é›„è”ç›Ÿ - ç®€åŒ–ç‰ˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #091428 0%, #0AC8E9 100%);
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            user-select: none;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto;
        }
        #ui {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #fff;
            z-index: 10;
        }
        #skillBar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        .skill {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #1a1a2e, #0f3460);
            border: 2px solid #c8aa6e;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            position: relative;
            transition: transform 0.1s;
        }
        .skill:hover { transform: scale(1.1); }
        .skill.cooldown {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .skill .cd {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #f0f;
        }
        #minimap {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 150px;
            height: 150px;
            background: rgba(0,0,0,0.5);
            border: 2px solid #c8aa6e;
            border-radius: 8px;
        }
        #startScreen, #gameOverScreen {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .hidden { display: none !important; }
        h1 {
            font-size: 48px;
            color: #c8aa6e;
            text-shadow: 0 0 20px #c8aa6e;
            margin-bottom: 30px;
        }
        .champion-select {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .champion {
            width: 100px;
            height: 120px;
            background: linear-gradient(135deg, #1a1a2e, #0f3460);
            border: 3px solid #333;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .champion:hover { transform: scale(1.1); border-color: #c8aa6e; }
        .champion.selected { border-color: #0f0; box-shadow: 0 0 20px #0f0; }
        .champion-icon { font-size: 40px; margin-bottom: 10px; }
        .champion-name { color: #fff; font-size: 14px; }
        .btn {
            padding: 15px 40px;
            font-size: 20px;
            background: linear-gradient(135deg, #c8aa6e, #e0d0a0);
            border: none;
            border-radius: 8px;
            color: #091428;
            font-weight: bold;
            cursor: pointer;
        }
        .btn:hover { transform: scale(1.05); }
        #killFeed {
            position: absolute;
            top: 60px;
            right: 10px;
            color: #fff;
            font-size: 14px;
            text-align: right;
        }
        .kill { margin: 5px 0; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="1200" height="700"></canvas>
    
    <div id="ui">
        <div style="color:#fff;font-size:18px;">
            <span style="color:#0f0">âš”ï¸ è‹±é›„è”ç›Ÿ</span> | 
            å‡»æ€: <span id="kills">0</span> | 
            é‡‘é’±: <span id="gold">0</span>
        </div>
    </div>
    
    <div id="skillBar">
        <div class="skill" id="skillQ" onclick="castSkill(0)">Q<span class="cd"></span></div>
        <div class="skill" id="skillW" onclick="castSkill(1)">W<span class="cd"></span></div>
        <div class="skill" id="skillE" onclick="castSkill(2)">E<span class="cd"></span></div>
        <div class="skill" id="skillR" onclick="castSkill(3)">R<span class="cd"></span></div>
        <div class="skill" onclick="attack()">ğŸ”ª</div>
    </div>
    
    <div id="killFeed"></div>
    
    <div id="startScreen">
        <h1>âš”ï¸ é€‰æ‹©ä½ çš„è‹±é›„</h1>
        <div class="champion-select">
            <div class="champion" onclick="selectChampion(0)">
                <span class="champion-icon">âš”ï¸</span>
                <span class="champion-name">ç›–ä¼¦</span>
                <span style="font-size:12px;color:#888">æˆ˜å£«</span>
            </div>
            <div class="champion" onclick="selectChampion(1)">
                <span class="champion-icon">ğŸ¹</span>
                <span class="champion-name">å¯’å†°</span>
                <span style="font-size:12px;color:#888">å°„æ‰‹</span>
            </div>
            <div class="champion" onclick="selectChampion(2)">
                <span class="champion-icon">ğŸ”®</span>
                <span class="champion-name">å…‰è¾‰</span>
                <span style="font-size:12px;color:#888">æ³•å¸ˆ</span>
            </div>
        </div>
        <button class="btn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
    </div>
    
    <div id="gameOverScreen" class="hidden">
        <h1 id="gameOverTitle">æ¸¸æˆç»“æŸ</h1>
        <p style="color:#fff;font-size:24px;margin-bottom:20px">å‡»æ€: <span id="finalKills">0</span></p>
        <button class="btn" onclick="location.reload()">å†æ¥ä¸€å±€</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const CHAMPIONS = [
            { name: 'ç›–ä¼¦', type: 'warrior', color: '#0f0', skills: ['Q-è‡´å‘½æ‰“å‡»', 'W-æŠ¤ç›¾', 'E-å®¡åˆ¤', 'R-å¾·ç›è¥¿äºš'], cd: [4, 8, 6, 60] },
            { name: 'å¯’å†°', type: 'adc', color: '#0ff', skills: ['Q-å°„å‡»', 'W-å†°éœœ', 'E-é¹°å‡»', 'R-é­”æ³•æ°´æ™¶'], cd: [3, 8, 10, 40] },
            { name: 'å…‰è¾‰', type: 'mage', color: '#f0f', skills: ['Q-å…‰ç›¾', 'E-é€å…‰', 'W-æŠ¤ç›¾', 'R-ç»ˆæé—ªå…‰'], cd: [5, 7, 6, 50] }
        ];
        
        let player, enemies, minions, towers, bullets, kills, gold, selectedChampion, skillCds;
        
        function selectChampion(idx) {
            selectedChampion = idx;
            document.querySelectorAll('.champion').forEach((c, i) => {
                c.classList.toggle('selected', i === idx);
            });
        }
        
        function startGame() {
            if (selectedChampion === undefined) {
                alert('è¯·å…ˆé€‰æ‹©è‹±é›„ï¼');
                return;
            }
            document.getElementById('startScreen').classList.add('hidden');
            
            const champ = CHAMPIONS[selectedChampion];
            player = {
                x: 600, y: 600, size: 30, color: champ.color,
                hp: 100, maxHp: 100, speed: 4,
                range: selectedChampion === 1 ? 200 : 80,
                damage: 20
            };
            enemies = [];
            minions = [];
            towers = [];
            bullets = [];
            kills = 0;
            gold = 0;
            skillCds = [0, 0, 0, 0];
            
            // åˆ›å»ºé˜²å¾¡å¡”
            towers.push({x: 100, y: 300, hp: 300, color: '#f00', type: 'enemy'});
            towers.push({x: 1100, y: 400, hp: 500, color: '#0f0', type: 'player'});
            
            // åˆ›å»ºå°å…µ
            spawnMinions();
            setInterval(spawnMinions, 5000);
            
            // åˆ›å»ºæ•Œæ–¹è‹±é›„
            enemies.push({
                x: 200, y: 350, size: 30, color: '#f00',
                hp: 100, damage: 15, speed: 3
            });
            
            gameLoop = setInterval(update, 30);
        }
        
        function spawnMinions() {
            // å·±æ–¹å°å…µ
            for (let i = 0; i < 3; i++) {
                minions.push({
                    x: 550 + i * 20, y: 580 + Math.random() * 40,
                    size: 15, color: '#0f0', hp: 30, damage: 5, speed: 2
                });
            }
            // æ•Œæ–¹å°å…µ
            for (let i = 0; i < 3; i++) {
                minions.push({
                    x: 650 + i * 20, y: 120 + Math.random() * 40,
                    size: 15, color: '#f00', hp: 30, damage: 5, speed: 2
                });
            }
        }
        
        const keys = {};
        document.addEventListener('keydown', e => keys[e.key] = true);
        document.addEventListener('keyup', e => keys[e.key] = false);
        
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶åœ°å›¾ï¼ˆå¬å”¤å¸ˆå³¡è°·ç®€åŒ–ç‰ˆï¼‰
            drawMap();
            
            // ç©å®¶ç§»åŠ¨
            if (keys['w'] || keys['W'] || keys['ArrowUp']) player.y = Math.max(50, player.y - player.speed);
            if (keys['s'] || keys['S'] || keys['ArrowDown']) player.y = Math.min(650, player.y + player.speed);
            if (keys['a'] || keys['A'] || keys['ArrowLeft']) player.x = Math.max(50, player.x - player.speed);
            if (keys['d'] || keys['D'] || keys['ArrowRight']) player.x = Math.min(1150, player.x + player.speed);
            
            // æŠ€èƒ½å†·å´
            for (let i = 0; i < 4; i++) {
                if (skillCds[i] > 0) skillCds[i]--;
                const el = document.querySelectorAll('.skill')[i];
                el.classList.toggle('cooldown', skillCds[i] > 0);
                el.querySelector('.cd').textContent = skillCds[i] || '';
            }
            
            // ç»˜åˆ¶é˜²å¾¡å¡”
            towers.forEach(t => {
                ctx.fillStyle = t.color;
                ctx.fillRect(t.x - 20, t.y - 20, 40, 40);
                ctx.fillStyle = '#fff';
                ctx.font = '12px Arial';
                ctx.fillText('HP:' + t.hp, t.x - 15, t.y - 25);
            });
            
            // å°å…µç§»åŠ¨å’Œç»˜åˆ¶
            minions.forEach((m, i) => {
                m.y += m.speed * (m.color === '#0f0' ? 1 : -1);
                drawUnit(m);
                
                // æ”»å‡»æ•Œæ–¹
                if (Math.abs(m.x - player.x) < 50 && Math.abs(m.y - player.y) < 50) {
                    if (m.color === '#f00') {
                        player.hp -= 0.5;
                    }
                }
            });
            
            // æ•Œæ–¹è‹±é›„
            enemies.forEach(e => {
                // AIç§»åŠ¨
                const dx = player.x - e.x;
                const dy = player.y - e.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                if (dist > 50) {
                    e.x += (dx/dist) * e.speed;
                    e.y += (dy/dist) * e.speed;
                } else {
                    player.hp -= 0.3;
                }
                drawUnit(e);
            });
            
            // ç»˜åˆ¶ç©å®¶
            drawUnit(player);
            
            // å­å¼¹
            bullets.forEach((b, i) => {
                b.x += b.vx;
                b.y += b.vy;
                ctx.fillStyle = b.color || '#ff0';
                ctx.beginPath();
                ctx.arc(b.x, b.y, 5, 0, Math.PI*2);
                ctx.fill();
                
                // ç¢°æ’æ£€æµ‹
                enemies.forEach((e, ei) => {
                    if (Math.abs(b.x - e.x) < 20 && Math.abs(b.y - e.y) < 20) {
                        e.hp -= 20;
                        bullets.splice(i, 1);
                        if (e.hp <= 0) {
                            enemies.splice(ei, 1);
                            kills++;
                            gold += 100;
                            addKillFeed('ä½  å‡»è´¥äº† æ•Œæ–¹è‹±é›„');
                            // å¤æ´»æ•Œäºº
                            setTimeout(() => enemies.push({
                                x: 200, y: 350, size: 30, color: '#f00',
                                hp: 100, damage: 15, speed: 3
                            }), 5000);
                        }
                    }
                });
                
                if (b.x < 0 || b.x > 1200 || b.y < 0 || b.y > 700) bullets.splice(i, 1);
            });
            
            // æ›´æ–°UI
            document.getElementById('kills').textContent = kills;
            document.getElementById('gold').textContent = gold;
            
            // æ¸¸æˆç»“æŸ
            if (player.hp <= 0) {
                clearInterval(gameLoop);
                document.getElementById('gameOverScreen').classList.remove('hidden');
                document.getElementById('finalKills').textContent = kills;
            }
        }
        
        function drawMap() {
            // æ²³é“
            ctx.strokeStyle = '#0af';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, 350);
            ctx.lineTo(1200, 350);
            ctx.stroke();
            
            // å…µçº¿
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 40;
            ctx.beginPath();
            ctx.moveTo(600, 0);
            ctx.lineTo(600, 700);
            ctx.stroke();
            
            // é‡åŒº
            ctx.fillStyle = 'rgba(0,100,0,0.3)';
            ctx.fillRect(100, 100, 200, 150);
            ctx.fillRect(900, 450, 200, 150);
        }
        
        function drawUnit(u) {
            ctx.fillStyle = u.color;
            ctx.beginPath();
            ctx.arc(u.x, u.y, u.size, 0, Math.PI * 2);
            ctx.fill();
            
            // HPæ¡
            ctx.fillStyle = '#333';
            ctx.fillRect(u.x - 20, u.y - u.size - 10, 40, 5);
            ctx.fillStyle = '#0f0';
            ctx.fillRect(u.x - 20, u.y - u.size - 10, 40 * (u.hp / (u.maxHp || 100), 5);
        }
        
        function attack() {
            bullets.push({
                x: player.x, y: player.y,
                vx: 0, vy: -10,
                color: player.color
            });
        }
        
        function castSkill(idx) {
            if (skillCds[idx] > 0) return;
            skillCds[idx] = CHAMPIONS[selectedChampion].cd[idx];
            
            if (idx === 0) { // Q
                bullets.push({x: player.x, y: player.y, vx: 0, vy: -15, color: '#ff0'});
            } else if (idx === 1) { // W
                player.hp = Math.min(player.maxHp, player.hp + 30);
            } else if (idx === 2) { // E
                for (let i = -2; i <= 2; i++) {
                    bullets.push({x: player.x + i*20, y: player.y, vx: 0, vy: -12, color: '#0ff'});
                }
            } else if (idx === 3) { // R
                for (let i = 0; i < 20; i++) {
                    bullets.push({
                        x: player.x, y: player.y - i*30,
                        vx: (Math.random()-0.5)*10, vy: 0,
                        color: '#f0f'
                    });
                }
            }
        }
        
        function addKillFeed(text) {
            const feed = document.getElementById('killFeed');
            const div = document.createElement('div');
            div.className = 'kill';
            div.textContent = text;
            feed.insertBefore(div, feed.firstChild);
            setTimeout(() => div.remove(), 3000);
        }
        
        let gameLoop;
    </script>
</body>
</html>
